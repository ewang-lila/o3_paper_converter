{
    "paper_id": "2506.17139v1",
    "llm_output": "### Problem 1  \n**Background.**  \nConsider the variance‐preserving (VP) stochastic differential equation (SDE) given by  \n\\[\n\\d{x} = -\\frac{1}{2}\\beta(t)\\, x\\,\\d{t} + \\sqrt{\\beta(t)}\\,\\d{w},\n\\]  \nwith the time‐dependent noise scale defined by  \n\\[\n\\beta(t) = \\beta_{\\min} + t\\,(\\beta_{\\max}-\\beta_{\\min}).\n\\]  \nFor such an affine SDE, the transition probability from the initial condition \\( x(0) \\) to the state \\( x(t) \\) can be written in closed form as a Gaussian distribution.\n\n**Task.**  \nShow that the transition kernel for this VP diffusion SDE can be expressed as  \n\\[\np_t(x(t) \\mid x(0)) = \\mathcal{N}\\!\\Bigl(x(t);\\, \\mu(x(0),t),\\, \\sigma(t)\\,I\\Bigr),\n\\]  \nwith the mean \\( \\mu(x(0),t) \\) and variance \\( \\sigma(t) \\) given in terms of the cumulative noise function. That is, derive the expression for  \n\\[\n\\mu(x(0),t)=\\exp\\!\\left(-\\tfrac{1}{2}\\int_0^t\\beta(s)\\,\\d{s}\\right)x(0)\n\\]  \nand  \n\\[\n\\sigma(t)=1-\\exp\\!\\left(-\\int_0^t\\beta(s)\\,\\d{s}\\right).\n\\]\n\n**Solution:**  \nThe final result appears verbatim in the paper as  \n\\[\np_t(x(t) \\mid x(0)) = \\mathcal{N}\\Bigl(x(t);\\, e^{-\\frac{1}{2}\\int_{0}^{t} \\beta(s)\\,\\d{s}}\\; x(0),\\, \\bigl(1 - e^{-\\int_{0}^{t} \\beta(s)\\,\\d{s}}\\bigr)\\,I\\Bigr).\n\\]\n——— (see Section “Diffusion” in the paper)\n\n---\n\n### Problem 2  \n**Background.**  \nIn energy-based diffusion models one needs to compute the time-derivative of the log-density \\(\\partial_t \\log p_t(x)\\). A finite-difference approximation based on sampled times is used to avoid computing derivatives exactly. Let \\(h_s\\) and \\(h_d\\) be small positive hyperparameters.  \n\n**Task.**  \nDerive the following finite-difference approximation for \\(\\partial_t \\log p_t(x)\\):\n\\[\n\\partial_t \\log p_t(x) \\approx \\frac{h_s^2\\,\\log p_t(x,\\,t+h_d) + \\bigl(h_d^2-h_s^2\\bigr)\\,\\log p_t(x,t) - h_d^2\\,\\log p_t(x,\\,t-h_s)}{h_s\\,h_d\\,(h_s+h_d)}.\n\\]\n\n**Solution:**  \nThe final expression is given verbatim in the paper as  \n\\[\n\\partial_t \\log p_t(x) \\approx \\frac{h_s^2\\,\\log p_t(x,\\,t+h_d) + \\bigl(h_d^2-h_s^2\\bigr)\\,\\log p_t(x,t) - h_d^2\\,\\log p_t(x,t-h_s)}{h_s\\,h_d\\,(h_s+h_d)}.\n\\]\n——— (see Equation (finite-difference) in the paper)\n\n---\n\n### Problem 3  \n**Background.**  \nFor a diffusion process governed by  \n\\[\n\\d{x} = f(x,t)\\,\\d{t} + g(t)\\,\\d{w},\n\\]  \nthe probability density \\( p_t(x) \\) evolves in time according to the Fokker–Planck equation. In logarithmic form, this equation relates the time-derivative of the log-density to derivatives of \\( \\log p_t(x) \\) and the drift \\( f(x,t) \\).\n\n**Task.**  \nShow that the log-density of \\( p_t(x) \\) satisfies the following equation:\n\\[\n\\partial_t \\log p_t(x) = \\frac{1}{2}\\,g^2(t)\\left[\\operatorname{div}_x\\!\\bigl(\\nabla_x \\log p_t(x)\\bigr) + \\left\\Vert \\nabla_x \\log p_t(x) \\right\\Vert_2^2\\right] - \\langle f(x,t),\\,\\nabla_x \\log p_t(x) \\rangle - \\operatorname{div}_x\\bigl(f(x,t)\\bigr).\n\\]\n\n**Solution:**  \nThe paper states the Fokker–Planck equation for the log-density verbatim as  \n\\[\n\\partial_t \\log p_t(x) = \\frac{1}{2}\\,g^2(t)\\left[\\operatorname{div}_x\\!\\bigl(\\nabla_x \\log p_t(x)\\bigr) + \\left\\Vert \\nabla_x \\log p_t(x) \\right\\Vert_2^2\\right] - \\langle f(x,t),\\,\\nabla_x \\log p_t(x) \\rangle - \\operatorname{div}_x\\bigl(f(x,t)\\bigr).\n\\]\n——— (see Equation (Fokker-Planck) in the paper)\n\n---\n\n### Problem 4  \n**Background.**  \nTo enforce that an energy-based diffusion model satisfies the Fokker–Planck equation, the paper introduces a residual  \n\\[\nR(x,t) = \\mathcal{F}_{p}(x,t) - \\partial_t \\log p_t(x),\n\\]  \nwhere  \n\\[\n\\mathcal{F}_{p}(x,t)= \\frac{1}{2}\\,g^2(t)\\left[\\operatorname{div}_x\\bigl(\\nabla_x \\log p_t(x)\\bigr) + \\|\\nabla_x \\log p_t(x)\\|_2^2\\right] - \\langle f(x,t), \\nabla_x \\log p_t(x)\\rangle - \\operatorname{div}_x\\bigl(f(x,t)\\bigr).\n\\]  \nSince directly computing higher-order derivatives (e.g. divergence) is computationally costly, a weak residual formulation is introduced. For a small parameter \\(\\sigma>0\\) and a perturbation \\( v \\sim \\mathcal{N}(0,\\sigma^2 I) \\), one defines an unbiased estimator \\( \\widetilde{R}(x,t;v) \\) of the residual using only first-order derivative information.\n\n**Task.**  \nShow that an unbiased estimator of the residual can be written as  \n\\[\n\\widetilde{R}(x,t; v) = \\frac{1}{2}\\,g^2(t)\\,\\left[ \\left(\\frac{v}{\\sigma}\\right)^\\top \\frac{s(x+v,t)-s(x-v,t)}{2\\sigma} + \\|s(x+v,t)\\|_2^2\\right] - \\langle f(x+v,t),\\, s(x+v,t)\\rangle - \\operatorname{div}_x\\bigl(f(x+v,t)\\bigr) - \\partial_t\\log p_t(x+v),\n\\]\nwhere the score \\( s(x,t) = \\nabla_x \\log p_t(x) \\).\n\n**Solution:**  \nThe final result in the paper is given verbatim as  \n\\[\n\\widetilde{R}(x,t; v) = \\frac{1}{2}\\,g^2(t)\\,\\left[ \\left(\\frac{v}{\\sigma}\\right)^\\top \\frac{s(x+v,t)-s(x-v,t)}{2\\sigma} + \\|s(x+v,t)\\|_2^2\\right] - \\langle f(x+v,t),\\, s(x+v,t)\\rangle - \\operatorname{div}_x\\bigl(f(x+v,t)\\bigr) - \\partial_t\\log p_t(x+v).\n\\]\nThis yields an unbiased estimator for the weak residual, which can then be used within the Fokker–Planck regularization loss.  \n——— (see Theorem “Weak Residual Formulation” in the paper)"
}